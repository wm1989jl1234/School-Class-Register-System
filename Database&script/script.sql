Use yiming1;

DROP TABLE ATTENDANCE;
DROP TABLE STUDENT;
DROP TABLE STUD_COMPANY;
DROP TABLE OFFERING;
DROP TABLE AUTHORIZED;
DROP TABLE LECTURER;
DROP TABLE TRAINING_SITE;
DROP TABLE COURSE;
DROP TABLE SUBJECT_AREA;
DROP TABLE SCHOLARSHIP;
DROP TABLE STUDENT_TYPE;

CREATE TABLE SUBJECT_AREA (
	SUBJECT_ID DECIMAL(2) NOT NULL,
	SUBJECT_NAME VARCHAR(30) NOT NULL,
	SUBJECT_EFF_DATE DATETIME NOT NULL,
	SUBJECT_EXP_DATE DATETIME,
	SUBJECT_TAX_PROFILE_CD VARCHAR(1) NOT NULL,
	SUBJECT_CERTIFIED VARCHAR(1) NOT NULL,
	SUBJECT_AUTH_LIMIT DECIMAL(9),
	UPDATE_TS DATETIME NOT NULL,
	PRIMARY KEY (SUBJECT_ID)
);

INSERT INTO SUBJECT_AREA(SUBJECT_ID, SUBJECT_NAME, SUBJECT_EFF_DATE, SUBJECT_EXP_DATE, SUBJECT_TAX_PROFILE_CD, SUBJECT_CERTIFIED, SUBJECT_AUTH_LIMIT, UPDATE_TS) VALUES (10, 'BUSINESS', '1990-06-15 00:00:00.0', null, 'A', 'Y', 1000000, '1990-10-01 17:14:15.0');
INSERT INTO SUBJECT_AREA(SUBJECT_ID, SUBJECT_NAME, SUBJECT_EFF_DATE, SUBJECT_EXP_DATE, SUBJECT_TAX_PROFILE_CD, SUBJECT_CERTIFIED, SUBJECT_AUTH_LIMIT, UPDATE_TS) VALUES (20, 'COMPUTING', '1990-06-15 00:00:00.0', null, 'S', 'Y', 800000, '1990-10-01 17:14:15.0');
INSERT INTO SUBJECT_AREA(SUBJECT_ID, SUBJECT_NAME, SUBJECT_EFF_DATE, SUBJECT_EXP_DATE, SUBJECT_TAX_PROFILE_CD, SUBJECT_CERTIFIED, SUBJECT_AUTH_LIMIT, UPDATE_TS) VALUES (30, 'ARTS', '1990-06-15 00:00:00.0', null, 'C', 'N', null, '1990-10-01 17:14:15.0');

CREATE TABLE COURSE (
	COURSE_ID DECIMAL(3) NOT NULL,
	TITLE VARCHAR(30) NOT NULL,
	COURSE_EFF_DATE DATETIME NOT NULL,
	COURSE_EXP_DATE DATETIME,
	DURATION DECIMAL(2),
	COST DECIMAL(5) NOT NULL,
	SUBJECT_ID DECIMAL(2) NOT NULL,
	UPDATE_TS DATETIME NOT NULL,
	PRIMARY KEY (COURSE_ID)
);

ALTER TABLE COURSE
	ADD FOREIGN KEY (SUBJECT_ID) 
	REFERENCES SUBJECT_AREA (SUBJECT_ID);

INSERT INTO COURSE(COURSE_ID, TITLE, COURSE_EFF_DATE, COURSE_EXP_DATE, DURATION, COST, SUBJECT_ID, UPDATE_TS) VALUES (101, 'HISTORY', '1996-06-15 00:00:00.0', null, 5, 375, 30, '2014-10-01 17:14:15.0');
INSERT INTO COURSE(COURSE_ID, TITLE, COURSE_EFF_DATE, COURSE_EXP_DATE, DURATION, COST, SUBJECT_ID, UPDATE_TS) VALUES (201, 'MANAGEMENT SCIENCE', '1996-06-15 00:00:00.0', null, 3, 405, 10, '2014-10-01 17:14:15.0');
INSERT INTO COURSE(COURSE_ID, TITLE, COURSE_EFF_DATE, COURSE_EXP_DATE, DURATION, COST, SUBJECT_ID, UPDATE_TS) VALUES (301, 'PHILOSOPHY', '1996-06-15 00:00:00.0', null, 2, 350, 30, '2014-10-01 17:14:15.0');
INSERT INTO COURSE(COURSE_ID, TITLE, COURSE_EFF_DATE, COURSE_EXP_DATE, DURATION, COST, SUBJECT_ID, UPDATE_TS) VALUES (401, 'CLASSIC', '1996-06-15 00:00:00.0', null, 3, 350, 30, '2014-10-01 17:14:15.0');
INSERT INTO COURSE(COURSE_ID, TITLE, COURSE_EFF_DATE, COURSE_EXP_DATE, DURATION, COST, SUBJECT_ID, UPDATE_TS) VALUES (501, 'MARKETING', '1996-06-15 00:00:00.0', null, 4, 425, 10, '2014-10-01 17:14:15.0');
INSERT INTO COURSE(COURSE_ID, TITLE, COURSE_EFF_DATE, COURSE_EXP_DATE, DURATION, COST, SUBJECT_ID, UPDATE_TS) VALUES (601, 'FORMAL SYSTEM AND LOGIC', '1996-06-15 00:00:00.0', null, 2, 400, 20, '2014-10-01 17:14:15.0');
INSERT INTO COURSE(COURSE_ID, TITLE, COURSE_EFF_DATE, COURSE_EXP_DATE, DURATION, COST, SUBJECT_ID, UPDATE_TS) VALUES (701, 'ACCOUNTING', '1996-06-15 00:00:00.0', '2006-01-11 00:00:00.0', 3, 500, 10, '2007-01-12 17:14:15.0');
INSERT INTO COURSE(COURSE_ID, TITLE, COURSE_EFF_DATE, COURSE_EXP_DATE, DURATION, COST, SUBJECT_ID, UPDATE_TS) VALUES (801, 'C++ PROGRAMMING', '2007-01-11 00:00:00.0', null, 4, 600, 20, '2014-10-01 17:14:15.0');
INSERT INTO COURSE(COURSE_ID, TITLE, COURSE_EFF_DATE, COURSE_EXP_DATE, DURATION, COST, SUBJECT_ID, UPDATE_TS) VALUES (901, 'FORTRAN', '1996-06-15 00:00:00.0', null, 5, 700, 20, '2014-10-01 17:14:15.0');

CREATE TABLE LECTURER (
	LECTURER_ID DECIMAL(3) NOT NULL,
	LECTURER_NAME VARCHAR(15) NOT NULL,
	SALARY DECIMAL(6,2),
	COMMISSION DECIMAL(6,2),
	MENTOR_ID DECIMAL(3),
	DATE_HIRED DATETIME NOT NULL,
	DATE_RELEASED DATETIME,
	UPDATE_TS DATETIME NOT NULL,
	PRIMARY KEY (LECTURER_ID)
);

ALTER TABLE LECTURER
	ADD FOREIGN KEY (MENTOR_ID) 
	REFERENCES LECTURER (LECTURER_ID);

INSERT INTO LECTURER(LECTURER_ID, LECTURER_NAME, SALARY, COMMISSION, MENTOR_ID, DATE_HIRED, DATE_RELEASED, UPDATE_TS) VALUES (621, 'STEVENSON', 5500, 200, null, '2006-06-15 00:00:00.0', null, '2011-01-21 17:14:15.0');
INSERT INTO LECTURER(LECTURER_ID, LECTURER_NAME, SALARY, COMMISSION, MENTOR_ID, DATE_HIRED, DATE_RELEASED, UPDATE_TS) VALUES (590, 'BIGGS', 5400, null, 621, '2007-01-01 00:00:00.0', null, '2009-01-01 17:14:15.0');
INSERT INTO LECTURER(LECTURER_ID, LECTURER_NAME, SALARY, COMMISSION, MENTOR_ID, DATE_HIRED, DATE_RELEASED, UPDATE_TS) VALUES (811, 'DORING', 3100, 100, 590, '1998-12-12 00:00:00.0', null, '2017-10-21 17:14:15.0');
INSERT INTO LECTURER(LECTURER_ID, LECTURER_NAME, SALARY, COMMISSION, MENTOR_ID, DATE_HIRED, DATE_RELEASED, UPDATE_TS) VALUES (795, 'WAYNE', 4100, 410, 590, '2003-07-09 00:00:00.0', null, '2013-01-01 17:14:15.0');
INSERT INTO LECTURER(LECTURER_ID, LECTURER_NAME, SALARY, COMMISSION, MENTOR_ID, DATE_HIRED, DATE_RELEASED, UPDATE_TS) VALUES (978, 'COUGAR', 2900, 240, 811, '2011-09-24 00:00:00.0', null, '2016-09-20 17:14:15.0');
INSERT INTO LECTURER(LECTURER_ID, LECTURER_NAME, SALARY, COMMISSION, MENTOR_ID, DATE_HIRED, DATE_RELEASED, UPDATE_TS) VALUES (700, 'STUART', 3700, null, 811, '1997-08-10 00:00:00.0', null, '2013-02-04 17:14:15.0');
INSERT INTO LECTURER(LECTURER_ID, LECTURER_NAME, SALARY, COMMISSION, MENTOR_ID, DATE_HIRED, DATE_RELEASED, UPDATE_TS) VALUES (297, 'CLAUS', 3400, 300, 978, '2012-01-06 00:00:00.0', null, '2017-01-21 17:14:15.0');

CREATE TABLE TRAINING_SITE (
	SITE_ID DECIMAL(2) NOT NULL,
	LOCATION VARCHAR(12) NOT NULL,
	SITE_EFF_DATE DATETIME NOT NULL,
	SITE_EXP_DATE DATETIME,
	SITE_MAX_SIZE DECIMAL(3) NOT NULL,
	UPDATE_TS DATETIME NOT NULL,
	SITE_SUPERVISOR VARCHAR(15),--new column
	SITE_COST DECIMAL(6) NOT NULL,--new column
	PRIMARY KEY (SITE_ID)
);

INSERT INTO TRAINING_SITE(SITE_ID, LOCATION, SITE_EFF_DATE, SITE_EXP_DATE, SITE_MAX_SIZE, UPDATE_TS,site_supervisor,SITE_COST) VALUES (1, 'EDMONTON', '2000-06-15 00:00:00.0', null, 80, '2013-10-01 18:14:15.0','Thomas',10000);
INSERT INTO TRAINING_SITE(SITE_ID, LOCATION, SITE_EFF_DATE, SITE_EXP_DATE, SITE_MAX_SIZE, UPDATE_TS,site_supervisor,SITE_COST) VALUES (2, 'CALGARY', '2001-06-15 00:00:00.0', null, 70, '2016-10-01 18:14:15.0','Dave',12000);
INSERT INTO TRAINING_SITE(SITE_ID, LOCATION, SITE_EFF_DATE, SITE_EXP_DATE, SITE_MAX_SIZE, UPDATE_TS,site_supervisor,SITE_COST) VALUES (3, 'CANMORE', '2002-06-15 00:00:00.0', null, 40, '2013-10-01 18:14:15.0','Tom',11000);
INSERT INTO TRAINING_SITE(SITE_ID, LOCATION, SITE_EFF_DATE, SITE_EXP_DATE, SITE_MAX_SIZE, UPDATE_TS,site_supervisor,SITE_COST) VALUES (4, 'RED DEER', '2003-06-15 00:00:00.0', null, 40, '2012-10-01 18:14:15.0','Dave',8000);
INSERT INTO TRAINING_SITE(SITE_ID, LOCATION, SITE_EFF_DATE, SITE_EXP_DATE, SITE_MAX_SIZE, UPDATE_TS,site_supervisor,SITE_COST) VALUES (5, 'LETHBRIDGE', '2009-06-15 00:00:00.0', null, 40, '2013-10-01 18:14:15.0','James',9000);
INSERT INTO TRAINING_SITE(SITE_ID, LOCATION, SITE_EFF_DATE, SITE_EXP_DATE, SITE_MAX_SIZE, UPDATE_TS,site_supervisor,SITE_COST) VALUES (6, 'JASPER', '2010-06-15 00:00:00.0', null, 40, '2012-10-01 18:14:15.0','Kobe',9500);
INSERT INTO TRAINING_SITE(SITE_ID, LOCATION, SITE_EFF_DATE, SITE_EXP_DATE, SITE_MAX_SIZE, UPDATE_TS,site_supervisor,SITE_COST) VALUES (7, 'CAMROSE', '2012-06-15 00:00:00.0', null, 45, '2016-10-01 18:14:15.0','Bryant',8880);

CREATE TABLE STUD_COMPANY (
	COMPANY_ID DECIMAL(3) NOT NULL,
	COMPANY_NAME VARCHAR(15) NOT NULL,
	CITY VARCHAR(12) NOT NULL,
	INDUSTRY VARCHAR(15) NOT NULL,
	NO_EMPLOYEES DECIMAL(5) NOT NULL,
	REVENUE DECIMAL(10),
	TRAINING_BUDGET DECIMAL(6) NOT NULL,
	UPDATE_TS DATETIME NOT NULL,
	PRIMARY KEY (COMPANY_ID)
);

INSERT INTO STUD_COMPANY(COMPANY_ID, COMPANY_NAME, CITY, INDUSTRY, NO_EMPLOYEES, REVENUE, TRAINING_BUDGET, UPDATE_TS) VALUES (10, 'IPL', 'EDMONTON', 'OIL AND GAS', 2000, 400000000, 100000, '2017-01-21 17:14:15.0');
INSERT INTO STUD_COMPANY(COMPANY_ID, COMPANY_NAME, CITY, INDUSTRY, NO_EMPLOYEES, REVENUE, TRAINING_BUDGET, UPDATE_TS) VALUES (20, 'CU', 'EDMONTON', 'UTILITY    ', 3000, 300000000, 50000, '2017-01-21 18:14:15.0');
INSERT INTO STUD_COMPANY(COMPANY_ID, COMPANY_NAME, CITY, INDUSTRY, NO_EMPLOYEES, REVENUE, TRAINING_BUDGET, UPDATE_TS) VALUES (30, 'JOES GARAGE ', 'EDMONTON', 'AUTOMOTIVE ', 2, 100000, 1, '2017-01-21 19:14:15.0');
INSERT INTO STUD_COMPANY(COMPANY_ID, COMPANY_NAME, CITY, INDUSTRY, NO_EMPLOYEES, REVENUE, TRAINING_BUDGET, UPDATE_TS) VALUES (40, 'NORTEL', 'OTTAWA  ', 'TELECOM    ', 10000, 700000000, 500000, '2016-01-21 20:14:15.0');
INSERT INTO STUD_COMPANY(COMPANY_ID, COMPANY_NAME, CITY, INDUSTRY, NO_EMPLOYEES, REVENUE, TRAINING_BUDGET, UPDATE_TS) VALUES (50, 'COREL', 'OTTAWA  ', 'SOFTWARE   ', 2300, 90000000, 50000, '2013-01-21 21:14:15.0');
INSERT INTO STUD_COMPANY(COMPANY_ID, COMPANY_NAME, CITY, INDUSTRY, NO_EMPLOYEES, REVENUE, TRAINING_BUDGET, UPDATE_TS) VALUES (60, 'AIR CANADA', 'MONTREAL', 'AIRLINE    ', 5000, 100000000, 100000, '2017-01-21 22:14:15.0');
INSERT INTO STUD_COMPANY(COMPANY_ID, COMPANY_NAME, CITY, INDUSTRY, NO_EMPLOYEES, REVENUE, TRAINING_BUDGET, UPDATE_TS) VALUES (70, 'IMPERIAL OIL', 'CALGARY ', 'OIL AND GAS', 8000, 550000000, 120000, '2017-01-21 23:14:15.0');

CREATE TABLE AUTHORIZED (
	LECTURER_ID DECIMAL(3) NOT NULL,
	COURSE_ID DECIMAL(3) NOT NULL,
	AUTH_EFF_DATE DATETIME NOT NULL,
	AUTH_EXP_DATE DATETIME,
	UPDATE_TS DATETIME NOT NULL,
	PRIMARY KEY (LECTURER_ID,COURSE_ID,AUTH_EFF_DATE)
);

ALTER TABLE AUTHORIZED
	ADD FOREIGN KEY (COURSE_ID) 
	REFERENCES COURSE (COURSE_ID);

ALTER TABLE AUTHORIZED
	ADD FOREIGN KEY (LECTURER_ID) 
	REFERENCES LECTURER (LECTURER_ID);

INSERT INTO AUTHORIZED(LECTURER_ID, COURSE_ID, AUTH_EFF_DATE, AUTH_EXP_DATE, UPDATE_TS) VALUES (297, 101, '2014-08-11 00:00:00.0', null, '2014-10-01 17:14:15.0');
INSERT INTO AUTHORIZED(LECTURER_ID, COURSE_ID, AUTH_EFF_DATE, AUTH_EXP_DATE, UPDATE_TS) VALUES (590, 401, '2009-09-21 00:00:00.0', null, '2010-10-01 17:14:15.0');
INSERT INTO AUTHORIZED(LECTURER_ID, COURSE_ID, AUTH_EFF_DATE, AUTH_EXP_DATE, UPDATE_TS) VALUES (590, 301, '2009-01-05 00:00:00.0', null, '2011-10-01 17:14:15.0');
INSERT INTO AUTHORIZED(LECTURER_ID, COURSE_ID, AUTH_EFF_DATE, AUTH_EXP_DATE, UPDATE_TS) VALUES (811, 701, '2009-04-17 00:00:00.0', null, '2013-10-01 17:14:15.0');
INSERT INTO AUTHORIZED(LECTURER_ID, COURSE_ID, AUTH_EFF_DATE, AUTH_EXP_DATE, UPDATE_TS) VALUES (811, 201, '2008-06-14 00:00:00.0', null, '2011-10-01 17:14:15.0');
INSERT INTO AUTHORIZED(LECTURER_ID, COURSE_ID, AUTH_EFF_DATE, AUTH_EXP_DATE, UPDATE_TS) VALUES (621, 501, '2008-07-27 00:00:00.0', null, '2014-10-01 17:14:15.0');
INSERT INTO AUTHORIZED(LECTURER_ID, COURSE_ID, AUTH_EFF_DATE, AUTH_EXP_DATE, UPDATE_TS) VALUES (700, 901, '2007-03-11 00:00:00.0', '2008-02-04 00:00:00.0', '2012-10-01 17:14:15.0');
INSERT INTO AUTHORIZED(LECTURER_ID, COURSE_ID, AUTH_EFF_DATE, AUTH_EXP_DATE, UPDATE_TS) VALUES (978, 801, '2015-08-03 00:00:00.0', null, '2015-10-01 17:14:15.0');
INSERT INTO AUTHORIZED(LECTURER_ID, COURSE_ID, AUTH_EFF_DATE, AUTH_EXP_DATE, UPDATE_TS) VALUES (795, 601, '2006-10-19 00:00:00.0', null, '2013-10-21 17:14:15.0');
INSERT INTO AUTHORIZED(LECTURER_ID, COURSE_ID, AUTH_EFF_DATE, AUTH_EXP_DATE, UPDATE_TS) VALUES (795, 801, '2007-05-22 00:00:00.0', null, '2014-10-01 17:14:15.0');

CREATE TABLE OFFERING (
	
	OFFERING_ID DECIMAL(5) NOT NULL,
	LECTURER_ID DECIMAL(3) NOT NULL,
	COURSE_ID DECIMAL(3) NOT NULL,
	AUTH_EFF_DATE DATETIME NOT NULL,
	SITE_ID DECIMAL(2) NOT NULL,
	START_DATE DATETIME NOT NULL,
	END_DATE DATETIME NOT NULL,
	MAX_NO_STUDENTS DECIMAL(2) NOT NULL,
	MIN_NO_STUDENTS DECIMAL(2) NOT NULL,
	TEXTS_RESERVED_QT DECIMAL(2) NOT NULL,
	TEXTS_GAP_QT DECIMAL(2) NOT NULL,
	UPDATE_TS DATETIME NOT NULL,
	OFFERING_TYPE VARCHAR(20),--newcolumn
	OFFERING_LANGUAGE VARCHAR(15),--new column
	PREMIUM DECIMAL(3),
	PRIMARY KEY (OFFERING_ID)
);

ALTER TABLE OFFERING
	ADD FOREIGN KEY (LECTURER_ID,COURSE_ID,AUTH_EFF_DATE) 
	REFERENCES AUTHORIZED (LECTURER_ID,COURSE_ID,AUTH_EFF_DATE);

ALTER TABLE OFFERING
	ADD FOREIGN KEY (SITE_ID) 
	REFERENCES TRAINING_SITE (SITE_ID);
ALTER TABLE OFFERING--q5
ADD CONSTRAINT chk_OFFERING CHECK (TEXTS_GAP_QT = MAX_NO_STUDENTS-TEXTS_RESERVED_QT)
ALTER TABLE OFFERING
ADD CONSTRAINT chk_OFFERING2 CHECK (TEXTS_RESERVED_QT<= MAX_NO_STUDENTS)
ALTER TABLE OFFERING
ADD CONSTRAINT chk_OFFERING3 CHECK (MIN_NO_STUDENTS<= MAX_NO_STUDENTS)
ALTER TABLE OFFERING
ADD CONSTRAINT chk_OFFERING4 CHECK (START_DATE<=END_DATE)
ALTER TABLE OFFERING
ADD CONSTRAINT chk_OFFERING5 CHECK (AUTH_EFF_DATE<=START_DATE)

--30,5----1,0
INSERT INTO OFFERING(OFFERING_ID, LECTURER_ID, COURSE_ID, AUTH_EFF_DATE, SITE_ID, START_DATE, END_DATE, MAX_NO_STUDENTS, MIN_NO_STUDENTS, TEXTS_RESERVED_QT, TEXTS_GAP_QT, UPDATE_TS,OFFERING_TYPE,offering_language) VALUES (9111, 795, 801, '2007-05-22 00:00:00.0', 6, '2017-01-01 00:00:00.0', '2017-04-01 00:00:00.0', 30, 5, 30, 0, '2017-10-21 17:14:15.0','Confirmed','English');
INSERT INTO OFFERING(OFFERING_ID, LECTURER_ID, COURSE_ID, AUTH_EFF_DATE, SITE_ID, START_DATE, END_DATE, MAX_NO_STUDENTS, MIN_NO_STUDENTS, TEXTS_RESERVED_QT, TEXTS_GAP_QT, UPDATE_TS,offering_type,offering_language) VALUES (9112, 590, 401, '2009-09-21 00:00:00.0', 7, '2018-07-15 00:00:00.0', '2018-12-19 00:00:00.0', 35, 5, 30, 5, '2017-10-21 17:14:15.0','Confirmed','English');
INSERT INTO OFFERING(OFFERING_ID, LECTURER_ID, COURSE_ID, AUTH_EFF_DATE, SITE_ID, START_DATE, END_DATE, MAX_NO_STUDENTS, MIN_NO_STUDENTS, TEXTS_RESERVED_QT, TEXTS_GAP_QT, UPDATE_TS,offering_type,offering_language) VALUES (9113, 795, 601, '2006-10-19 00:00:00.0', 6, '2018-09-07 00:00:00.0', '2018-12-17 00:00:00.0', 40, 3, 37, 3, '2017-10-21 17:14:15.0','Confirmed','English');
INSERT INTO OFFERING(OFFERING_ID, LECTURER_ID, COURSE_ID, AUTH_EFF_DATE, SITE_ID, START_DATE, END_DATE, MAX_NO_STUDENTS, MIN_NO_STUDENTS, TEXTS_RESERVED_QT, TEXTS_GAP_QT, UPDATE_TS,offering_type,offering_language) VALUES (9211, 811, 201, '2008-06-14 00:00:00.0', 2, '2018-05-03 00:00:00.0', '2018-07-03 00:00:00.0', 25, 3, 20, 5, '2017-10-21 17:14:15.0','Cancelled',null);
INSERT INTO OFFERING(OFFERING_ID, LECTURER_ID, COURSE_ID, AUTH_EFF_DATE, SITE_ID, START_DATE, END_DATE, MAX_NO_STUDENTS, MIN_NO_STUDENTS, TEXTS_RESERVED_QT, TEXTS_GAP_QT, UPDATE_TS,offering_type,offering_language) VALUES (9212, 621, 501, '2008-07-27 00:00:00.0', 2, '2016-08-15 00:00:00.0', '2016-12-25 00:00:00.0', 30, 5, 30, 0, '2017-10-21 17:14:15.0','Onetime',null);
INSERT INTO OFFERING(OFFERING_ID, LECTURER_ID, COURSE_ID, AUTH_EFF_DATE, SITE_ID, START_DATE, END_DATE, MAX_NO_STUDENTS, MIN_NO_STUDENTS, TEXTS_RESERVED_QT, TEXTS_GAP_QT, UPDATE_TS,offering_type,offering_language) VALUES (9213, 621, 501, '2008-07-27 00:00:00.0', 1, '2018-08-16 00:00:00.0', '2018-12-17 00:00:00.0', 40, 2, 30, 10, '2017-10-21 17:14:15.0','Confirmed','Korean');
INSERT INTO OFFERING(OFFERING_ID, LECTURER_ID, COURSE_ID, AUTH_EFF_DATE, SITE_ID, START_DATE, END_DATE, MAX_NO_STUDENTS, MIN_NO_STUDENTS, TEXTS_RESERVED_QT, TEXTS_GAP_QT, UPDATE_TS,offering_type,offering_language) VALUES (9311, 700, 901, '2007-03-11 00:00:00.0', 3, '2017-02-23 00:00:00.0', '2017-10-23 00:00:00.0', 15, 5, 15, 0, '2017-10-23 17:14:15.0','Confirmed','Japanese');
INSERT INTO OFFERING(OFFERING_ID, LECTURER_ID, COURSE_ID, AUTH_EFF_DATE, SITE_ID, START_DATE, END_DATE, MAX_NO_STUDENTS, MIN_NO_STUDENTS, TEXTS_RESERVED_QT, TEXTS_GAP_QT, UPDATE_TS,offering_type,offering_language) VALUES (9312, 700, 901, '2007-03-11 00:00:00.0', 3, '2017-04-12 00:00:00.0', '2017-07-12 00:00:00.0', 25, 5, 25, 0, '2017-10-21 17:14:15.0','Confirmed','Japanese');

--new column
CREATE TABLE SCHOLARSHIP(
	SCHOLARSHIP_ID DECIMAL(5) NOT NULL,
	SCHOLARSHIP_TYPE VARCHAR(20) NOT NULL,
	AMOUNT_RECEIVED DECIMAL (7,2) NOT NULL,
	START_DATE DATETIME NOT NULL,
	EXP_DATE DATETIME, 
	SPONSOR VARCHAR(10),
	
	PRIMARY KEY(SCHOLARSHIP_ID)
);
INSERT INTO SCHOLARSHIP(SCHOLARSHIP_ID,SCHOLARSHIP_TYPE,AMOUNT_RECEIVED,START_DATE,EXP_DATE,SPONSOR)VALUES(11111,'ACDEMIC',1000,'05-05-2015',null,'School');
INSERT INTO SCHOLARSHIP(SCHOLARSHIP_ID,SCHOLARSHIP_TYPE,AMOUNT_RECEIVED,START_DATE,EXP_DATE,SPONSOR)VALUES(22222,'LEADERSHIP',1500,'02-03-2014',null,'School');
INSERT INTO SCHOLARSHIP(SCHOLARSHIP_ID,SCHOLARSHIP_TYPE,AMOUNT_RECEIVED,START_DATE,EXP_DATE,SPONSOR)VALUES(33333,'COMPETITION',2000,'04-03-2014',null,'Not School');
--new column
CREATE TABLE STUDENT_TYPE(
	STUDENT_TYPE_ID DECIMAL(3) NOT NULL,
	TYP_NAME VARCHAR(20),
	TUITION VARCHAR(20) NOT NULL,
	
	PRIMARY KEY(STUDENT_TYPE_ID)
);
INSERT INTO STUDENT_TYPE(STUDENT_TYPE_ID,TYP_NAME,TUITION)VALUES(123,'LOCAL','NORMAL');
INSERT INTO STUDENT_TYPE(STUDENT_TYPE_ID,TYP_NAME,TUITION)VALUES(456,'INTERNATIONAL','3 TIMES');
INSERT INTO STUDENT_TYPE(STUDENT_TYPE_ID,TYP_NAME,TUITION)VALUES(789,'PART-TIME','NORMAL');

CREATE TABLE STUDENT (
	STUDENT_ID DECIMAL(5) NOT NULL,
	STUDENT_FNAME VARCHAR(10) NOT NULL,
	STUDENT_LNAME VARCHAR(12) NOT NULL,
	TEL_AREA_CD VARCHAR(3),
	TEL_NO VARCHAR(7),
	FAX_AREA_CD VARCHAR(3),
	FAX_NO VARCHAR(7),
	GENDER VARCHAR(1),
	DATE_OF_BIRTH DATETIME NOT NULL,
	STUDENT_DESC VARCHAR(50),
	PREFERRED_LANGUAGE VARCHAR(2),
	HIGHEST_DIPL_ACH VARCHAR(4),
	HAS_VACCIN_CERT VARCHAR(1),
	COMPANY_ID DECIMAL(3) NOT NULL,
	SCHOLARSHIP_ID decimal(5),
	STUDENT_TYPE decimal(3),
	UPDATE_TS DATETIME NOT NULL,
	PRIMARY KEY (STUDENT_ID)
);

ALTER TABLE STUDENT
	ADD FOREIGN KEY (COMPANY_ID) 
	REFERENCES STUD_COMPANY (COMPANY_ID);
ALTER TABLE STUDENT--add new foreign keys to table student
	ADD FOREIGN KEY (SCHOLARSHIP_ID)
	REFERENCES SCHOLARSHIP(SCHOLARSHIP_ID);
ALTER TABLE STUDENT
	ADD FOREIGN KEY (STUDENT_TYPE)
	REFERENCES student_type(student_type_id);

INSERT INTO STUDENT(STUDENT_ID, STUDENT_FNAME, STUDENT_LNAME, TEL_AREA_CD, TEL_NO, FAX_AREA_CD, FAX_NO, GENDER, DATE_OF_BIRTH, STUDENT_DESC, PREFERRED_LANGUAGE, HIGHEST_DIPL_ACH, HAS_VACCIN_CERT, COMPANY_ID,SCHOLARSHIP_ID,STUDENT_TYPE, UPDATE_TS) VALUES (12345, 'BILL', 'SMITH', '403', '4211234', '403', '4211235', 'M', '1966-01-01 00:00:00.0', 'D L 6', 'EN', 'GR12', 'N', 20,11111,123, '2018-01-01 13:14:15.0');
INSERT INTO STUDENT(STUDENT_ID, STUDENT_FNAME, STUDENT_LNAME, TEL_AREA_CD, TEL_NO, FAX_AREA_CD, FAX_NO, GENDER, DATE_OF_BIRTH, STUDENT_DESC, PREFERRED_LANGUAGE, HIGHEST_DIPL_ACH, HAS_VACCIN_CERT, COMPANY_ID,SCHOLARSHIP_ID,STUDENT_TYPE, UPDATE_TS) VALUES (21145, 'MICHAEL', 'BARRETT', '403', '4246666', '403', '4246667', 'M', '1994-04-01 00:00:00.0', null, 'EN', 'BSC ', 'N', 30,22222,456, '2018-01-02 14:14:15.0');
INSERT INTO STUDENT(STUDENT_ID, STUDENT_FNAME, STUDENT_LNAME, TEL_AREA_CD, TEL_NO, FAX_AREA_CD, FAX_NO, GENDER, DATE_OF_BIRTH, STUDENT_DESC, PREFERRED_LANGUAGE, HIGHEST_DIPL_ACH, HAS_VACCIN_CERT, COMPANY_ID,SCHOLARSHIP_ID,STUDENT_TYPE, UPDATE_TS) VALUES (23765, 'KEVIN', 'JOHNSTON', '203', '2218975', '203', '2218976', 'M', '1988-09-21 00:00:00.0', 'D L 3', 'EN', 'LT12', 'N', 10,33333,789, '2018-01-03 15:14:15.0');
INSERT INTO STUDENT(STUDENT_ID, STUDENT_FNAME, STUDENT_LNAME, TEL_AREA_CD, TEL_NO, FAX_AREA_CD, FAX_NO, GENDER, DATE_OF_BIRTH, STUDENT_DESC, PREFERRED_LANGUAGE, HIGHEST_DIPL_ACH, HAS_VACCIN_CERT, COMPANY_ID,SCHOLARSHIP_ID,STUDENT_TYPE, UPDATE_TS) VALUES (24953, 'TERRY', 'TYLER', '403', '4522386', '403', '4522387', 'F', '1994-01-12 00:00:00.0', 'D L 2', 'FR', 'LT12', 'N', 20,11111,123, '2018-01-04 16:14:15.0');
INSERT INTO STUDENT(STUDENT_ID, STUDENT_FNAME, STUDENT_LNAME, TEL_AREA_CD, TEL_NO, FAX_AREA_CD, FAX_NO, GENDER, DATE_OF_BIRTH, STUDENT_DESC, PREFERRED_LANGUAGE, HIGHEST_DIPL_ACH, HAS_VACCIN_CERT, COMPANY_ID,SCHOLARSHIP_ID,STUDENT_TYPE, UPDATE_TS) VALUES (83537, 'GEORGE', 'NEWMAN', '416', '4373497', '416', '4373498', 'M', '1989-06-15 00:00:00.0', null, 'EN', 'MSC ', 'Y', 10,11111,456, '2018-01-05 17:14:15.0');
INSERT INTO STUDENT(STUDENT_ID, STUDENT_FNAME, STUDENT_LNAME, TEL_AREA_CD, TEL_NO, FAX_AREA_CD, FAX_NO, GENDER, DATE_OF_BIRTH, STUDENT_DESC, PREFERRED_LANGUAGE, HIGHEST_DIPL_ACH, HAS_VACCIN_CERT, COMPANY_ID,SCHOLARSHIP_ID,STUDENT_TYPE, UPDATE_TS) VALUES (73467, 'PETRA', 'FERNS', '203', '2317634', '203', '2317635', 'F', '1985-02-25 00:00:00.0', null, 'EN', '2YCT', 'N', 10,22222,789, '2018-01-06 18:14:15.0');
INSERT INTO STUDENT(STUDENT_ID, STUDENT_FNAME, STUDENT_LNAME, TEL_AREA_CD, TEL_NO, FAX_AREA_CD, FAX_NO, GENDER, DATE_OF_BIRTH, STUDENT_DESC, PREFERRED_LANGUAGE, HIGHEST_DIPL_ACH, HAS_VACCIN_CERT, COMPANY_ID,SCHOLARSHIP_ID,STUDENT_TYPE, UPDATE_TS) VALUES (84853, 'INGRID', 'SVEN', '406', '5466743', '406', '5466744', 'F', '1993-07-07 00:00:00.0', 'D L 4', 'GR', '2YCT', 'N', 20,33333,123, '2018-01-07 19:14:15.0');
INSERT INTO STUDENT(STUDENT_ID, STUDENT_FNAME, STUDENT_LNAME, TEL_AREA_CD, TEL_NO, FAX_AREA_CD, FAX_NO, GENDER, DATE_OF_BIRTH, STUDENT_DESC, PREFERRED_LANGUAGE, HIGHEST_DIPL_ACH, HAS_VACCIN_CERT, COMPANY_ID,SCHOLARSHIP_ID,STUDENT_TYPE, UPDATE_TS) VALUES (54643, 'PETER', 'ARCHER', '403', '4610101', '403', '4610102', 'M', '1992-12-17 00:00:00.0', 'D L 9', 'EN', '2YCT', 'Y', 50, 22222,123,'2018-01-08 20:14:15.0');
INSERT INTO STUDENT(STUDENT_ID, STUDENT_FNAME, STUDENT_LNAME, TEL_AREA_CD, TEL_NO, FAX_AREA_CD, FAX_NO, GENDER, DATE_OF_BIRTH, STUDENT_DESC, PREFERRED_LANGUAGE, HIGHEST_DIPL_ACH, HAS_VACCIN_CERT, COMPANY_ID,SCHOLARSHIP_ID,STUDENT_TYPE, UPDATE_TS) VALUES (32132, 'CINDY', 'TURNER', '403', '9883827', '403', '9883828', 'F', '1998-11-27 00:00:00.0', null, 'FR', 'BSC ', 'N', 60, 33333,456,'2018-01-09 21:14:15.0');
INSERT INTO STUDENT(STUDENT_ID, STUDENT_FNAME, STUDENT_LNAME, TEL_AREA_CD, TEL_NO, FAX_AREA_CD, FAX_NO, GENDER, DATE_OF_BIRTH, STUDENT_DESC, PREFERRED_LANGUAGE, HIGHEST_DIPL_ACH, HAS_VACCIN_CERT, COMPANY_ID,SCHOLARSHIP_ID,STUDENT_TYPE, UPDATE_TS) VALUES (34599, 'DICK', 'JONES', '203', '7833973', '203', '7833974', 'M', '1996-03-16 00:00:00.0', 'D L 1', 'EN', 'BSC ', 'N', 20,11111,456, '2018-01-10 22:14:15.0');
INSERT INTO STUDENT(STUDENT_ID, STUDENT_FNAME, STUDENT_LNAME, TEL_AREA_CD, TEL_NO, FAX_AREA_CD, FAX_NO, GENDER, DATE_OF_BIRTH, STUDENT_DESC, PREFERRED_LANGUAGE, HIGHEST_DIPL_ACH, HAS_VACCIN_CERT, COMPANY_ID,SCHOLARSHIP_ID,STUDENT_TYPE, UPDATE_TS) VALUES (98351, 'PAUL', 'MARKS', '703', '3432345', '703', '3432346', 'M', '1987-12-12 00:00:00.0', null, 'EN', 'LT12', 'Y', 20, 22222,123,'2018-01-11 23:14:15.0');

CREATE TABLE ATTENDANCE (
	OFFERING_ID DECIMAL(5) NOT NULL,
	STUDENT_ID DECIMAL(5) NOT NULL,
	REGSTRN_MADE_DATE DATETIME NOT NULL,
	REGSTRN_CANC_DATE DATETIME,
	EVALUATION VARCHAR(1),
	PENALTY VARCHAR(1),
	FINAL_MARK VARCHAR(1),
	AMOUNT_PAID DECIMAL(6,2),
	UPDATE_TS DATETIME NOT NULL,
	ATTENDANCE_RATE DECIMAL(2,2), 
	FAILURE_RATE DECIMAL(2,2) NOT NULL,
	
	PRIMARY KEY (OFFERING_ID,STUDENT_ID,REGSTRN_MADE_DATE)
);

ALTER TABLE ATTENDANCE
	ADD FOREIGN KEY (STUDENT_ID) 
	REFERENCES STUDENT (STUDENT_ID);

ALTER TABLE ATTENDANCE
	ADD FOREIGN KEY (OFFERING_ID) 
	REFERENCES OFFERING (OFFERING_ID);
	--insert into offering
INSERT INTO OFFERING(OFFERING_ID, LECTURER_ID, COURSE_ID, AUTH_EFF_DATE, SITE_ID, START_DATE, END_DATE, MAX_NO_STUDENTS, MIN_NO_STUDENTS, TEXTS_RESERVED_QT, TEXTS_GAP_QT, UPDATE_TS,OffERING_TYPE,offering_language) VALUES (1111, 795, 801, '2007-05-22 00:00:00.0', 6, '2017-01-01 00:00:00.0', '2017-04-01 00:00:00.0', 30, 5, 30, 0, '2017-10-21 17:14:15.0','confirmed','Spanish');
INSERT INTO OFFERING(OFFERING_ID, LECTURER_ID, COURSE_ID, AUTH_EFF_DATE, SITE_ID, START_DATE, END_DATE, MAX_NO_STUDENTS, MIN_NO_STUDENTS, TEXTS_RESERVED_QT, TEXTS_GAP_QT, UPDATE_TS,OffERING_TYPE,offering_language) VALUES (2222, 795, 801, '2007-05-22 00:00:00.0', 6, '2017-01-01 00:00:00.0', '2017-04-01 00:00:00.0', 30, 5, 30, 0, '2017-10-21 17:14:15.0','confirmed','ENGLish');
INSERT INTO OFFERING(OFFERING_ID, LECTURER_ID, COURSE_ID, AUTH_EFF_DATE, SITE_ID, START_DATE, END_DATE, MAX_NO_STUDENTS, MIN_NO_STUDENTS, TEXTS_RESERVED_QT, TEXTS_GAP_QT, UPDATE_TS,OffERING_TYPE,offering_language) VALUES (3333, 795, 801, '2007-05-22 00:00:00.0', 6, '2017-01-01 00:00:00.0', '2017-04-01 00:00:00.0', 30, 5, 30, 0, '2017-10-21 17:14:15.0','confirmed','Korean');
INSERT INTO OFFERING(OFFERING_ID, LECTURER_ID, COURSE_ID, AUTH_EFF_DATE, SITE_ID, START_DATE, END_DATE, MAX_NO_STUDENTS, MIN_NO_STUDENTS, TEXTS_RESERVED_QT, TEXTS_GAP_QT, UPDATE_TS,OffERING_TYPE,offering_language) VALUES (4444, 795, 801, '2007-05-22 00:00:00.0', 6, '2017-01-01 00:00:00.0', '2017-04-01 00:00:00.0', 30, 5, 30, 0, '2017-10-21 17:14:15.0','confirmed','ENGLish');
INSERT INTO OFFERING(OFFERING_ID, LECTURER_ID, COURSE_ID, AUTH_EFF_DATE, SITE_ID, START_DATE, END_DATE, MAX_NO_STUDENTS, MIN_NO_STUDENTS, TEXTS_RESERVED_QT, TEXTS_GAP_QT, UPDATE_TS,OffERING_TYPE,offering_language) VALUES (5555, 795, 801, '2007-05-22 00:00:00.0', 6, '2017-01-01 00:00:00.0', '2017-04-01 00:00:00.0', 30, 5, 30, 0, '2017-10-21 17:14:15.0','confirmed','ENGLish');
INSERT INTO OFFERING(OFFERING_ID, LECTURER_ID, COURSE_ID, AUTH_EFF_DATE, SITE_ID, START_DATE, END_DATE, MAX_NO_STUDENTS, MIN_NO_STUDENTS, TEXTS_RESERVED_QT, TEXTS_GAP_QT, UPDATE_TS,OffERING_TYPE,offering_language) VALUES (6666, 795, 801, '2007-05-22 00:00:00.0', 6, '2017-01-01 00:00:00.0', '2017-04-01 00:00:00.0', 30, 5, 30, 0, '2017-10-21 17:14:15.0','onetime','Portuguese');
INSERT INTO OFFERING(OFFERING_ID, LECTURER_ID, COURSE_ID, AUTH_EFF_DATE, SITE_ID, START_DATE, END_DATE, MAX_NO_STUDENTS, MIN_NO_STUDENTS, TEXTS_RESERVED_QT, TEXTS_GAP_QT, UPDATE_TS,OffERING_TYPE,offering_language) VALUES (7777, 795, 801, '2007-05-22 00:00:00.0', 6, '2017-01-01 00:00:00.0', '2017-04-01 00:00:00.0', 30, 5, 30, 0, '2017-10-21 17:14:15.0','confirmed','ENGLish');
INSERT INTO OFFERING(OFFERING_ID, LECTURER_ID, COURSE_ID, AUTH_EFF_DATE, SITE_ID, START_DATE, END_DATE, MAX_NO_STUDENTS, MIN_NO_STUDENTS, TEXTS_RESERVED_QT, TEXTS_GAP_QT, UPDATE_TS,OffERING_TYPE,offering_language) VALUES (8888, 795, 801, '2007-05-22 00:00:00.0', 6, '2017-01-01 00:00:00.0', '2017-04-01 00:00:00.0', 30, 5, 30, 0, '2017-10-21 17:14:15.0','confirmed','ENGLish');
INSERT INTO OFFERING(OFFERING_ID, LECTURER_ID, COURSE_ID, AUTH_EFF_DATE, SITE_ID, START_DATE, END_DATE, MAX_NO_STUDENTS, MIN_NO_STUDENTS, TEXTS_RESERVED_QT, TEXTS_GAP_QT, UPDATE_TS,OffERING_TYPE,offering_language) VALUES (9999, 795, 801, '2007-05-22 00:00:00.0', 6, '2017-01-01 00:00:00.0', '2017-04-01 00:00:00.0', 30, 5, 30, 0, '2017-10-21 17:14:15.0','confirmed','ENGLish');
INSERT INTO OFFERING(OFFERING_ID, LECTURER_ID, COURSE_ID, AUTH_EFF_DATE, SITE_ID, START_DATE, END_DATE, MAX_NO_STUDENTS, MIN_NO_STUDENTS, TEXTS_RESERVED_QT, TEXTS_GAP_QT, UPDATE_TS,OffERING_TYPE,offering_language) VALUES (0000, 795, 801, '2007-05-22 00:00:00.0', 6, '2017-01-01 00:00:00.0', '2017-04-01 00:00:00.0', 30, 5, 30, 0, '2017-10-21 17:14:15.0','onetime','ENGLish');
--insert into student
INSERT INTO STUDENT(STUDENT_ID, STUDENT_FNAME, STUDENT_LNAME, TEL_AREA_CD, TEL_NO, FAX_AREA_CD, FAX_NO, GENDER, DATE_OF_BIRTH, STUDENT_DESC, PREFERRED_LANGUAGE, HIGHEST_DIPL_ACH, HAS_VACCIN_CERT, COMPANY_ID,SCHOLARSHIP_ID,STUDENT_TYPE, UPDATE_TS) VALUES (11111, 'BIlly', 'SMIT', '403', '4211234', '403', '4211235', 'M', '1966-01-01 00:00:00.0', 'D L 6', 'EN', 'GR12', 'N', 20,11111,123, '2018-01-01 13:14:15.0');
INSERT INTO STUDENT(STUDENT_ID, STUDENT_FNAME, STUDENT_LNAME, TEL_AREA_CD, TEL_NO, FAX_AREA_CD, FAX_NO, GENDER, DATE_OF_BIRTH, STUDENT_DESC, PREFERRED_LANGUAGE, HIGHEST_DIPL_ACH, HAS_VACCIN_CERT, COMPANY_ID,SCHOLARSHIP_ID,STUDENT_TYPE, UPDATE_TS) VALUES (22222, 'MICAL', 'BAETT', '403', '4246666', '403', '4246667', 'M', '1994-04-01 00:00:00.0', null, 'EN', 'BSC ', 'N', 30,22222,456, '2018-01-02 14:14:15.0');
INSERT INTO STUDENT(STUDENT_ID, STUDENT_FNAME, STUDENT_LNAME, TEL_AREA_CD, TEL_NO, FAX_AREA_CD, FAX_NO, GENDER, DATE_OF_BIRTH, STUDENT_DESC, PREFERRED_LANGUAGE, HIGHEST_DIPL_ACH, HAS_VACCIN_CERT, COMPANY_ID,SCHOLARSHIP_ID,STUDENT_TYPE, UPDATE_TS) VALUES (33333, 'KEV', 'JOHN', '203', '2218975', '203', '2218976', 'M', '1988-09-21 00:00:00.0', 'D L 3', 'EN', 'LT12', 'N', 10,33333,123, '2018-01-03 15:14:15.0');
INSERT INTO STUDENT(STUDENT_ID, STUDENT_FNAME, STUDENT_LNAME, TEL_AREA_CD, TEL_NO, FAX_AREA_CD, FAX_NO, GENDER, DATE_OF_BIRTH, STUDENT_DESC, PREFERRED_LANGUAGE, HIGHEST_DIPL_ACH, HAS_VACCIN_CERT, COMPANY_ID,SCHOLARSHIP_ID,STUDENT_TYPE, UPDATE_TS) VALUES (44444, 'TER', 'TTOER', '403', '4522386', '403', '4522387', 'F', '1994-01-12 00:00:00.0', 'D L 2', 'FR', 'LT12', 'N', 20,11111,456, '2018-01-04 16:14:15.0');
INSERT INTO STUDENT(STUDENT_ID, STUDENT_FNAME, STUDENT_LNAME, TEL_AREA_CD, TEL_NO, FAX_AREA_CD, FAX_NO, GENDER, DATE_OF_BIRTH, STUDENT_DESC, PREFERRED_LANGUAGE, HIGHEST_DIPL_ACH, HAS_VACCIN_CERT, COMPANY_ID,SCHOLARSHIP_ID,STUDENT_TYPE, UPDATE_TS) VALUES (55555, 'GEO', 'NEW', '416', '4373497', '416', '4373498', 'M', '1989-06-15 00:00:00.0', null, 'EN', 'MSC ', 'Y', 10,22222,123, '2018-01-05 17:14:15.0');
INSERT INTO STUDENT(STUDENT_ID, STUDENT_FNAME, STUDENT_LNAME, TEL_AREA_CD, TEL_NO, FAX_AREA_CD, FAX_NO, GENDER, DATE_OF_BIRTH, STUDENT_DESC, PREFERRED_LANGUAGE, HIGHEST_DIPL_ACH, HAS_VACCIN_CERT, COMPANY_ID,SCHOLARSHIP_ID,STUDENT_TYPE, UPDATE_TS) VALUES (66666, 'PET', 'FERS', '203', '2317634', '203', '2317635', 'F', '1985-02-25 00:00:00.0', null, 'EN', '2YCT', 'N', 10,22222,456, '2018-01-06 18:14:15.0');
INSERT INTO STUDENT(STUDENT_ID, STUDENT_FNAME, STUDENT_LNAME, TEL_AREA_CD, TEL_NO, FAX_AREA_CD, FAX_NO, GENDER, DATE_OF_BIRTH, STUDENT_DESC, PREFERRED_LANGUAGE, HIGHEST_DIPL_ACH, HAS_VACCIN_CERT, COMPANY_ID,SCHOLARSHIP_ID,STUDENT_TYPE, UPDATE_TS) VALUES (77777, 'INGRI', 'SVE', '406', '5466743', '406', '5466744', 'F', '1993-07-07 00:00:00.0', 'D L 4', 'GR', '2YCT', 'N', 20,11111,789, '2018-01-07 19:14:15.0');
INSERT INTO STUDENT(STUDENT_ID, STUDENT_FNAME, STUDENT_LNAME, TEL_AREA_CD, TEL_NO, FAX_AREA_CD, FAX_NO, GENDER, DATE_OF_BIRTH, STUDENT_DESC, PREFERRED_LANGUAGE, HIGHEST_DIPL_ACH, HAS_VACCIN_CERT, COMPANY_ID,SCHOLARSHIP_ID,STUDENT_TYPE, UPDATE_TS) VALUES (88888, 'PER', 'ARCH', '403', '4610101', '403', '4610102', 'M', '1992-12-17 00:00:00.0', 'D L 9', 'EN', '2YCT', 'Y', 50, 22222,789,'2018-01-08 20:14:15.0');
INSERT INTO STUDENT(STUDENT_ID, STUDENT_FNAME, STUDENT_LNAME, TEL_AREA_CD, TEL_NO, FAX_AREA_CD, FAX_NO, GENDER, DATE_OF_BIRTH, STUDENT_DESC, PREFERRED_LANGUAGE, HIGHEST_DIPL_ACH, HAS_VACCIN_CERT, COMPANY_ID,SCHOLARSHIP_ID,STUDENT_TYPE, UPDATE_TS) VALUES (99999, 'CIND', 'TUNER', '403', '9883827', '403', '9883828', 'F', '1998-11-27 00:00:00.0', null, 'FR', 'BSC ', 'N', 60, 33333,789,'2018-01-09 21:14:15.0');
INSERT INTO STUDENT(STUDENT_ID, STUDENT_FNAME, STUDENT_LNAME, TEL_AREA_CD, TEL_NO, FAX_AREA_CD, FAX_NO, GENDER, DATE_OF_BIRTH, STUDENT_DESC, PREFERRED_LANGUAGE, HIGHEST_DIPL_ACH, HAS_VACCIN_CERT, COMPANY_ID,SCHOLARSHIP_ID,STUDENT_TYPE, UPDATE_TS) VALUES (00000, 'DIK', 'JONE', '203', '7833973', '203', '7833974', 'M', '1996-03-16 00:00:00.0', 'D L 1', 'EN', 'BSC ', 'N', 20,11111,789, '2018-01-10 22:14:15.0');
--insert into attendance
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (9111, 98351, '2016-12-21 00:00:00.0', null, '7', '0', '7', 600, 0.9, 0.01, '2017-01-05 18:14:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (9111, 84853, '2016-12-11 00:00:00.0', null, '6', '1', '5', 600, 0.8, 0.2, '2017-01-05 19:14:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (9112, 98351, '2018-06-03 00:00:00.0', null, '5', '0', '5', 700, 0.85, 0.15, '2018-07-21 18:14:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (9112, 54643, '2018-06-02 00:00:00.0', null, '8', '1', '7', 400, 0.7, 0.18, '2018-07-21 19:14:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (9211, 21145, '2018-05-01 00:00:00.0', null, '7', '0', '7', 405, 0.95, 0.1, '2018-05-01 18:14:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (9211, 23765, '2018-05-09 00:00:00.0', null, '5', '0', '5', 405, 0.80, 0.02, '2018-05-11 19:14:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (9213, 12345, '2018-08-11 00:00:00.0', null, '3', '0', '3', 200, 0.6, 0.23, '2018-08-06 18:14:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (9311, 21145, '2017-01-31 00:00:00.0', null, '2', '0', '2', 350, 0.7, 0.18, '2017-02-25 18:14:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (9311, 73467, '2017-02-11 00:00:00.0', null, '7', '0', '7', 350, 0.92, 0.10, '2017-02-10 18:19:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (9311, 32132, '2017-02-21 00:00:00.0', null, '9', '0', '9', 325, 0.85, 0.21, '2017-02-25 18:21:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (9312, 83537, '2017-01-01 00:00:00.0', null, '7', '0', '7', 300, 0.96, 0.16, '2017-04-13 14:13:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (9312, 24953, '2017-01-01 00:00:00.0', null, '9', '1', '8', 350, 0.5, 0.18, '2017-04-13 15:11:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (9312, 32132, '2017-01-01 00:00:00.0', null, '9', '0', '9', 350, 0.89, 0.2, '2017-04-13 16:10:15.0');
--insert into attendance 
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (9312, 21145, '2017-01-01 00:00:00.0', null, '9', '0', '9', 350, 0.89, 0.2, '2017-04-13 16:10:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (9311, 98351, '2017-01-01 00:00:00.0', null, '9', '0', '9', 350, 0.89, 0.2, '2017-04-13 16:10:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (9311, 73467, '2017-01-01 00:00:00.0', null, '9', '0', '9', 350, 0.89, 0.2, '2017-04-13 16:10:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (9111, 12345, '2017-01-01 00:00:00.0', null, '9', '0', '9', 350, 0.89, 0.2, '2017-04-13 16:10:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (9112, 24953, '2017-01-01 00:00:00.0', null, '9', '0', '9', 350, 0.89, 0.2, '2017-04-13 16:10:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (9112, 32132, '2017-01-01 00:00:00.0', null, '9', '0', '9', 350, 0.89, 0.2, '2017-04-13 16:10:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (9112, 12345, '2017-01-01 00:00:00.0', null, '9', '0', '9', 350, 0.89, 0.2, '2017-04-13 16:10:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (9213, 12345, '2017-01-01 00:00:00.0', null, '9', '0', '9', 350, 0.89, 0.2, '2017-04-13 16:10:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (9213, 83537, '2017-01-01 00:00:00.0', null, '9', '0', '9', 350, 0.89, 0.2, '2017-04-13 16:10:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (9213, 73467, '2017-01-01 00:00:00.0', null, '9', '0', '9', 350, 0.89, 0.2, '2017-04-13 16:10:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (9311, 12345, '2017-01-01 00:00:00.0', null, '9', '0', '9', 350, 0.89, 0.2, '2017-04-13 16:10:15.0');

INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (1111, 11111, '2017-01-01 00:00:00.0', null, '9', '0', '9', 350, 0.89, 0.2, '2017-04-13 16:10:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (2222, 22222, '2017-01-01 00:00:00.0', null, '9', '0', '9', 350, 0.89, 0.2, '2017-04-13 16:10:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (3333, 33333, '2017-01-01 00:00:00.0', null, '9', '0', '9', 350, 0.89, 0.2, '2017-04-13 16:10:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (4444, 44444, '2017-01-01 00:00:00.0', null, '9', '0', '9', 350, 0.89, 0.2, '2017-04-13 16:10:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (5555, 55555, '2017-01-01 00:00:00.0', null, '9', '0', '9', 350, 0.89, 0.2, '2017-04-13 16:10:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (6666, 66666, '2016-12-21 00:00:00.0', null, '7', '0', '7', 600, 0.9, 0.01, '2017-01-05 18:14:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (7777, 77777, '2016-12-11 00:00:00.0', null, '6', '1', '5', 600, 0.8, 0.2, '2017-01-05 19:14:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (8888, 88888, '2018-06-03 00:00:00.0', null, '5', '0', '5', 700, 0.85, 0.15, '2018-07-21 18:14:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (9999, 99999, '2018-06-02 00:00:00.0', null, '8', '1', '7', 400, 0.7, 0.18, '2018-07-21 19:14:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (0000, 00000, '2018-05-01 00:00:00.0', null, '7', '0', '7', 405, 0.95, 0.1, '2018-05-01 18:14:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (1111, 22222, '2018-05-09 00:00:00.0', null, '5', '0', '5', 405, 0.80, 0.02, '2018-05-11 19:14:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (2222, 33333, '2018-08-11 00:00:00.0', null, '3', '0', '3', 200, 0.6, 0.23, '2018-08-06 18:14:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (3333, 44444, '2017-01-31 00:00:00.0', null, '2', '0', '2', 350, 0.7, 0.18, '2017-02-25 18:14:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (4444, 55555, '2017-02-11 00:00:00.0', null, '7', '0', '7', 350, 0.92, 0.10, '2017-02-10 18:19:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (5555, 66666, '2017-02-21 00:00:00.0', null, '9', '0', '9', 325, 0.85, 0.21, '2017-02-25 18:21:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (6666, 77777, '2017-01-01 00:00:00.0', null, '7', '0', '7', 300, 0.96, 0.16, '2017-04-13 14:13:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (7777, 88888, '2017-01-01 00:00:00.0', null, '9', '1', '8', 350, 0.5, 0.18, '2017-04-13 15:11:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (8888, 99999, '2017-01-01 00:00:00.0', null, '9', '0', '9', 350, 0.89, 0.2, '2017-04-13 16:10:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (6666, 88888, '2017-01-01 00:00:00.0', null, '7', '0', '7', 300, 0.96, 0.16, '2017-04-13 14:13:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (7777, 99999, '2017-01-01 00:00:00.0', null, '9', '1', '8', 350, 0.5, 0.18, '2017-04-13 15:11:15.0');
INSERT INTO ATTENDANCE(OFFERING_ID, STUDENT_ID, REGSTRN_MADE_DATE, REGSTRN_CANC_DATE, EVALUATION, PENALTY, FINAL_MARK, AMOUNT_PAID, ATTENDANCE_RATE, FAILURE_RATE, UPDATE_TS) VALUES (8888, 11111, '2017-01-01 00:00:00.0', null, '9', '0', '9', 350, 0.89, 0.2, '2017-04-13 16:10:15.0');
--insert into company oil and gas
INSERT INTO STUD_COMPANY(COMPANY_ID, COMPANY_NAME, CITY, INDUSTRY, NO_EMPLOYEES, REVENUE, TRAINING_BUDGET, UPDATE_TS) VALUES (11, 'AAB', 'EDMONTON', 'OIL AND GAS', 2000, 400000000, 100000, '2017-01-21 17:14:15.0');
INSERT INTO STUD_COMPANY(COMPANY_ID, COMPANY_NAME, CITY, INDUSTRY, NO_EMPLOYEES, REVENUE, TRAINING_BUDGET, UPDATE_TS) VALUES (21, 'AAC', 'EDMONTON', 'OIL AND GAS', 3000, 300000000, 50000, '2017-01-21 18:14:15.0');
INSERT INTO STUD_COMPANY(COMPANY_ID, COMPANY_NAME, CITY, INDUSTRY, NO_EMPLOYEES, REVENUE, TRAINING_BUDGET, UPDATE_TS) VALUES (31, 'ACC', 'EDMONTON', 'OIL AND GAS', 2, 100000, 1, '2017-01-21 19:14:15.0');
INSERT INTO STUD_COMPANY(COMPANY_ID, COMPANY_NAME, CITY, INDUSTRY, NO_EMPLOYEES, REVENUE, TRAINING_BUDGET, UPDATE_TS) VALUES (41, 'DCC', 'OTTAWA  ', 'OIL AND GAS', 10000, 700000000, 500000, '2016-01-21 20:14:15.0');
INSERT INTO STUD_COMPANY(COMPANY_ID, COMPANY_NAME, CITY, INDUSTRY, NO_EMPLOYEES, REVENUE, TRAINING_BUDGET, UPDATE_TS) VALUES (51, 'CEE', 'OTTAWA  ', 'OIL AND GAS', 2300, 90000000, 50000, '2013-01-21 21:14:15.0');
INSERT INTO STUD_COMPANY(COMPANY_ID, COMPANY_NAME, CITY, INDUSTRY, NO_EMPLOYEES, REVENUE, TRAINING_BUDGET, UPDATE_TS) VALUES (61, 'QQE', 'MONTREAL', 'OIL AND GAS', 5000, 100000000, 100000, '2017-01-21 22:14:15.0');
INSERT INTO STUD_COMPANY(COMPANY_ID, COMPANY_NAME, CITY, INDUSTRY, NO_EMPLOYEES, REVENUE, TRAINING_BUDGET, UPDATE_TS) VALUES (71, 'QQD', 'CALGARY ', 'OIL AND GAS', 8000, 550000000, 120000, '2017-01-21 23:14:15.0');
--insert into company utilities
INSERT INTO STUD_COMPANY(COMPANY_ID, COMPANY_NAME, CITY, INDUSTRY, NO_EMPLOYEES, REVENUE, TRAINING_BUDGET, UPDATE_TS) VALUES (12, 'CCA', 'EDMONTON', 'UTILITY    ', 2000, 400000000, 100000, '2017-01-21 17:14:15.0');
INSERT INTO STUD_COMPANY(COMPANY_ID, COMPANY_NAME, CITY, INDUSTRY, NO_EMPLOYEES, REVENUE, TRAINING_BUDGET, UPDATE_TS) VALUES (22, 'DDS', 'EDMONTON', 'UTILITY    ', 3000, 300000000, 50000, '2017-01-21 18:14:15.0');
INSERT INTO STUD_COMPANY(COMPANY_ID, COMPANY_NAME, CITY, INDUSTRY, NO_EMPLOYEES, REVENUE, TRAINING_BUDGET, UPDATE_TS) VALUES (32, 'JDE ', 'EDMONTON', 'UTILITY    ', 2, 100000, 1, '2017-01-21 19:14:15.0');
INSERT INTO STUD_COMPANY(COMPANY_ID, COMPANY_NAME, CITY, INDUSTRY, NO_EMPLOYEES, REVENUE, TRAINING_BUDGET, UPDATE_TS) VALUES (42, 'HHF', 'OTTAWA  ', 'UTILITY    ', 10000, 700000000, 500000, '2016-01-21 20:14:15.0');
INSERT INTO STUD_COMPANY(COMPANY_ID, COMPANY_NAME, CITY, INDUSTRY, NO_EMPLOYEES, REVENUE, TRAINING_BUDGET, UPDATE_TS) VALUES (52, 'EWQ', 'OTTAWA  ', 'UTILITY    ', 2300, 90000000, 50000, '2013-01-21 21:14:15.0');
INSERT INTO STUD_COMPANY(COMPANY_ID, COMPANY_NAME, CITY, INDUSTRY, NO_EMPLOYEES, REVENUE, TRAINING_BUDGET, UPDATE_TS) VALUES (62, 'GDF', 'MONTREAL', 'UTILITY    ', 5000, 100000000, 100000, '2017-01-21 22:14:15.0');
INSERT INTO STUD_COMPANY(COMPANY_ID, COMPANY_NAME, CITY, INDUSTRY, NO_EMPLOYEES, REVENUE, TRAINING_BUDGET, UPDATE_TS) VALUES (72, 'IOP', 'CALGARY ', 'UTILITY    ', 8000, 550000000, 120000, '2017-01-21 23:14:15.0');
--insert into company telecom
INSERT INTO STUD_COMPANY(COMPANY_ID, COMPANY_NAME, CITY, INDUSTRY, NO_EMPLOYEES, REVENUE, TRAINING_BUDGET, UPDATE_TS) VALUES (13, 'PLM', 'EDMONTON', 'TELECOM    ', 2000, 400000000, 100000, '2017-01-21 17:14:15.0');
INSERT INTO STUD_COMPANY(COMPANY_ID, COMPANY_NAME, CITY, INDUSTRY, NO_EMPLOYEES, REVENUE, TRAINING_BUDGET, UPDATE_TS) VALUES (23, 'JUI', 'EDMONTON', 'TELECOM    ', 3000, 300000000, 50000, '2017-01-21 18:14:15.0');
INSERT INTO STUD_COMPANY(COMPANY_ID, COMPANY_NAME, CITY, INDUSTRY, NO_EMPLOYEES, REVENUE, TRAINING_BUDGET, UPDATE_TS) VALUES (33, 'HGR', 'EDMONTON', 'TELECOM    ', 2, 100000, 1, '2017-01-21 19:14:15.0');
INSERT INTO STUD_COMPANY(COMPANY_ID, COMPANY_NAME, CITY, INDUSTRY, NO_EMPLOYEES, REVENUE, TRAINING_BUDGET, UPDATE_TS) VALUES (43, 'NMB', 'OTTAWA  ', 'TELECOM    ', 10000, 700000000, 500000, '2016-01-21 20:14:15.0');
INSERT INTO STUD_COMPANY(COMPANY_ID, COMPANY_NAME, CITY, INDUSTRY, NO_EMPLOYEES, REVENUE, TRAINING_BUDGET, UPDATE_TS) VALUES (53, 'CNM', 'OTTAWA  ', 'TELECOM    ', 2300, 90000000, 50000, '2013-01-21 21:14:15.0');
INSERT INTO STUD_COMPANY(COMPANY_ID, COMPANY_NAME, CITY, INDUSTRY, NO_EMPLOYEES, REVENUE, TRAINING_BUDGET, UPDATE_TS) VALUES (63, 'DSB', 'MONTREAL', 'TELECOM    ', 5000, 100000000, 100000, '2017-01-21 22:14:15.0');
INSERT INTO STUD_COMPANY(COMPANY_ID, COMPANY_NAME, CITY, INDUSTRY, NO_EMPLOYEES, REVENUE, TRAINING_BUDGET, UPDATE_TS) VALUES (73, 'QNM', 'CALGARY ','TELECOM    ', 8000, 550000000, 120000, '2017-01-21 23:14:15.0');

drop table BUS_MES
CREATE TABLE BUS_MES (
	[MESSAGE_ID] [decimal](5, 0) NOT NULL,
	[MESSAGE_TYPE] [varchar](1) NOT NULL,
	[MESSAGE_TEXT] [nvarchar](150) NOT NULL

	PRIMARY KEY (Message_ID));
ALTER TABLE BUS_MSG
drop constraint chk_BUS_MSG
ALTER TABLE BUS_MSG
ADD CONSTRAINT chk_BUS_MSG CHECK (MESSAGE_ID>=50000)
ALTER TABLE BUS_MSG
drop constraint chk_BUS_MSG2
ALTER TABLE BUS_MSG
ADD CONSTRAINT chk_BUS_MSG2 CHECK (MESSAGE_TYPE IN ('E','W','I'));
go
DROP FUNCTION count_attendance
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE FUNCTION [dbo].[count_attendance] --Q3
(
	-- Add the input parameters for the function (if any) here
	@offering_id decimal(5,0)
)
RETURNS decimal(9,2)  -- this is the datatype of the ONE return value
AS
BEGIN

DECLARE @ret decimal(9,2);     -- declares a local variable called @ret
    /*SELECT @ret = count(*) 
    FROM dbo.attendance a
	WHERE a.OFFERING_ID = @offering_id
	group by a.offering_id;*/
	SELECT @ret = count(a.Offering_id) FROM dbo.attendance a
	WHERE @OFFERING_ID = a.offering_id
	group by a.offering_id;
    RETURN @ret;
END
go
drop function count_maximum;
go
CREATE FUNCTION [dbo].[count_maximum] --Q4
(
	-- Add the input parameters for the function (if any) here
	@offering_id decimal(5,0)
)
RETURNS decimal(9,0)  -- this is the datatype of the ONE return value
AS
BEGIN
DECLARE @ret decimal(9,2);     -- declares a local variable called @ret
    SELECT @ret = max(a.amount_paid) 
    FROM dbo.attendance a
	WHERE a.OFFERING_ID = @offering_id
	group by a.offering_id;
   
    RETURN @ret;
END
GO
IF OBJECT_ID(N'Total_count','TR') IS NOT NULL
DROP TRIGGER Total_count--trigger Q6
GO
CREATE TRIGGER Total_count ON ATTENDANCE AFTER insert
AS
SET NOCOUNT ON;
DECLARE
@OFFERING_iD DECIMAL(5), 
@CT_NUM DECIMAL (1),
@MAX_stud decimal (2)
SELECT @OFFERING_ID = OFFERING_ID from inserted

SELECT @CT_NUM = COUNT(offering_id) FROM ATTENDANCE 
WHERE @OFFERING_ID = OFFERING_ID
select @MAX_stud = MAX_NO_STUDENTS from offering where @OFFERING_iD = offering_id
IF @CT_NUM > @MAX_stud
BEGIN 
PRINT 'Cant update course ' + cast(@OFFERING_ID as varchar) + ' because it is over capacity'
	ROLLBACK ;
	END;
--q7
GO
IF OBJECT_ID(N'premium','TR') IS NOT NULL
drop trigger premium
GO
create trigger premium on attendance after insert
AS
declare 
@MAX_paid DECIMAL(2),
@PREM DECIMAL(1),
@OFFERING_ID DECIMAL(5),
@paid decimal(3),
@Course_C DECIMAL (5)
SELECT @OFFERING_ID = OFFERING_ID FROM inserted;
SELECT @MAX_paid = max(AMOUNT_PAID)
FROM ATTENDANCE 
WHERE @OFFERING_ID = ATTENDANCE.OFFERING_ID
SELECT @PREM= isnull(PREMIUM,0) FROM OFFERING WHERE @OFFERING_ID = OFFERING_ID
SELECT @Course_C = A.COST FROM COURSE A,AUTHORIZED B ,OFFERING C WHERE A.COURSE_ID = B.COURSE_ID AND B.COURSE_ID = C.COURSE_ID AND @OFFERING_ID = OFFERING_ID
IF @Course_C + @PREM > @MAX_paid
BEGIN  
PRINT
'MORE THAN COST+PREMIUM: ' 
ROLLBACK;
END

GO
IF OBJECT_ID(N'Max_not_less','TR') IS NOT NULL
drop trigger Max_not_less--q8
GO
create trigger Max_not_less on offering after insert
AS
declare 
@MAXIMUM DECIMAL(2),
@COUNT DECIMAL(1),
@OFFERING_ID DECIMAL(5)
SELECT @OFFERING_ID = OFFERING_ID from inserted 
select @MAXIMUM = MAX_NO_STUDENTS FROM OFFERING where @offering_id = offering_id;
SELECT @COUNT = COUNT(offering_id)
FROM ATTENDANCE 
WHERE @OFFERING_ID = ATTENDANCE.OFFERING_ID
IF @COUNT> @MAXIMUM
BEGIN 
PRINT
'MAXIMUM NUMBER OF STUDENTS IS LESS THAN TOTAL COUNT OF ATTENDANCE FOR OFFERING: '
ROLLBACK;
END
GO
IF OBJECT_ID(N'Less_than_site','TR') IS NOT NULL
drop trigger Less_than_site--q9
GO
create trigger Less_than_site on offering after insert
AS
declare 
@MAXIMUM DECIMAL(2),
@SITEMAX DECIMAL(2),
@OFFERING_ID DECIMAL(5),
@site_id decimal(1)
SELECT @OFFERING_ID = OFFERING_ID, @MAXIMUM = MAX_NO_STUDENTS, @site_id = offering.SITE_ID FROM OFFERING ;
SELECT @SITEMAX = SITE_MAX_SIZE
FROM  TRAINING_SITE 
WHERE SITE_ID = @site_id
IF @SITEMAX> @MAXIMUM
BEGIN 
PRINT
'over capacity: ' 
ROLLBACK;
END

GO
drop procedure [dbo].[uspReceiveCourseInfo] --10.1
go
create PROCEDURE [dbo].[uspReceiveCourseInfo] 
	-- Add the parameters for the stored procedure here
	@Course_id Decimal = null
AS
BEGIN
               -- SET NOCOUNT ON added to prevent extra result sets from
               -- interfering with SELECT statements.
  SET NOCOUNT ON;
               -- Insert statements for procedure here
  SELECT *
  FROM [dbo].[Course]
  WHERE Course_id = @Course_id;
END

GO--Q10.2
drop procedure [dbo].[uspGetAllCourseInfo] 
go
CREATE PROCEDURE [dbo].[uspGetAllCourseInfo] 
	-- Add the parameters for the stored procedure here
AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    -- Insert statements for procedure here
	SELECT *
  FROM [dbo].[Course]
END
--q11
GO
drop procedure [dbo].[usp_Get_Message]
go
CREATE PROCEDURE [dbo].[usp_Get_Message]
@MESSAGE_ID DECIMAL(5,0),
@MESSAGE_TYPE VARCHAR(1) OUTPUT,
@MESSAGE_TEXT NVARCHAR(150) OUTPUT
AS
BEGIN
 --SET @MESSAGE_TYPE = 'E';
 --SET @MESSAGE_TEXT = 'GENERIC ERROR MESSAGE HAND-TYPED INTO STUB';
SELECT @MESSAGE_TYPE = [MESSAGE_TYPE],@MESSAGE_TEXT = [MESSAGE_TEXT]
  FROM [dbo].[BUS_MES]
WHERE [MESSAGE_ID] = @MESSAGE_ID;
RETURN
END
--Q13
go
drop procedure [dbo].[usp_Push_4_RetCd]
go
CREATE PROCEDURE [dbo].[usp_Push_4_RetCd]
	@New_msg as decimal(5,0)
	,@RetCd1 as decimal(5,0) output
	,@RetCd2 decimal(5,0) output
	,@RetCd3 decimal(5,0) output
	,@RetCd4 decimal(5,0) output
	/*,@RetCd5 decimal(5,0) output
	,@RetCd6 decimal(5,0) output
	,@RetCd7 decimal(5,0) output
	,@RetCd8 decimal(5,0) output*/
as
begin
			/*Set @RetCd8 = @RetCd7;
			Set @RetCd7 = @RetCd6;
			Set @RetCd6 = @RetCd5;
			Set @RetCd5 = @RetCd4;*/
			Set @RetCd4 = @RetCd3;
			Set @RetCd3 = @RetCd2;
			Set @RetCd2 = @RetCd1;
			Set @RetCd1 = @New_msg;
end
GO
--Q15
INSERT INTO bus_msg ( MESSAGE_ID, MESSAGE_TYPE, MESSAGE_TEXT) VALUES ( 50101, 'E', 'GENERIC ERROR MESSAGE HAND-TYPED INTO STUB') 

INSERT INTO bus_msg ( MESSAGE_ID, MESSAGE_TYPE, MESSAGE_TEXT) VALUES ( 50102, 'E', 'GENERIC ERROR MESSAGE HAND-TYPED INTO STUB') 

INSERT INTO bus_msg ( MESSAGE_ID, MESSAGE_TYPE, MESSAGE_TEXT) VALUES ( 50103, 'E', 'GENERIC ERROR MESSAGE HAND-TYPED INTO STUB') 

INSERT INTO bus_msg ( MESSAGE_ID, MESSAGE_TYPE, MESSAGE_TEXT) VALUES ( 50104, 'E', 'GENERIC ERROR MESSAGE HAND-TYPED INTO STUB')

INSERT INTO bus_msg ( MESSAGE_ID, MESSAGE_TYPE, MESSAGE_TEXT) VALUES ( 50111, 'E', 'GENERIC ERROR MESSAGE HAND-TYPED INTO STUB') 

INSERT INTO bus_msg ( MESSAGE_ID, MESSAGE_TYPE, MESSAGE_TEXT) VALUES ( 50112, 'E', 'GENERIC ERROR MESSAGE HAND-TYPED INTO STUB')  

INSERT INTO bus_msg ( MESSAGE_ID, MESSAGE_TYPE, MESSAGE_TEXT) VALUES ( 50113, 'E', 'GENERIC ERROR MESSAGE HAND-TYPED INTO STUB')

INSERT INTO bus_msg ( MESSAGE_ID, MESSAGE_TYPE, MESSAGE_TEXT) VALUES ( 50114, 'E', 'GENERIC ERROR MESSAGE HAND-TYPED INTO STUB')

INSERT INTO bus_msg ( MESSAGE_ID, MESSAGE_TYPE, MESSAGE_TEXT) VALUES ( 50115, 'E', 'GENERIC ERROR MESSAGE HAND-TYPED INTO STUB') 

INSERT INTO bus_msg ( MESSAGE_ID, MESSAGE_TYPE, MESSAGE_TEXT) VALUES ( 50116, 'E', 'GENERIC ERROR MESSAGE HAND-TYPED INTO STUB') 

INSERT INTO bus_msg ( MESSAGE_ID, MESSAGE_TYPE, MESSAGE_TEXT) VALUES ( 50117, 'E', 'GENERIC ERROR MESSAGE HAND-TYPED INTO STUB') 

INSERT INTO bus_msg ( MESSAGE_ID, MESSAGE_TYPE, MESSAGE_TEXT) VALUES ( 50118, 'E', 'GENERIC ERROR MESSAGE HAND-TYPED INTO STUB')   
--16
DROP PROC uspUpdateCOURSE_01;
GO

CREATE PROCEDURE [dbo].[uspUpdateCOURSE_01]
	@I_COURSE_ID AS DECIMAL(3,0), 
	@I_TITLE AS VARCHAR(30),
	@I_COURSE_EFF_DATE AS DATETIME,
	@I_COURSE_EXP_DATE AS DATETIME,
	@I_DURATION AS DECIMAL(2,0),
	@I_COST AS DECIMAL(5,0),
	@I_Update_TS AS datetime,
	--@I_SUBJECT_AUTH_LIMIT as decimal,
	@RetCd1 As decimal(5,0) output, 
	@RetCd2 AS decimal(5,0) output, 
	@RetCd3 AS decimal(5,0) output, 
	@RetCd4 AS decimal(5,0) output,
	@O_TITLE AS VARCHAR(30)output,
	@O_COURSE_EFF_DATE AS DATETIME output,
	@O_COURSE_EXP_DATE AS DATETIME output,
	@O_DURATION AS DECIMAL(2,0) output,
	@O_COST AS DECIMAL(5,0) OUTPUT,
	@O_Update_TS AS datetime output
AS
BEGIN
	SET NOCOUNT ON;
	DECLARE @TrStat nvarchar(2) = null,
		@COURSE_ID AS DECIMAL(3,0), 
		@TITLE AS VARCHAR(30),
		@COURSE_EFF_DATE AS DATETIME,
		@COURSE_EXP_DATE AS DATETIME,
		@DURATION AS DECIMAL(2,0),
		@COST AS DECIMAL(5,0), 
		@Update_TS AS datetime,
        @OfferAttend_COUNT AS decimal(5),
		@SUBJECT_AUTH_LIMIT as decimal(9,0);
		--@OFFERING_ID AS DECIMAL(5,0);
	Set @TrStat = null;
	Set @RetCd1 = 0;
	Set @RetCd2 = 0;
	Set @RetCd3 = 0;
	Set @RetCd4 = 0;
	Set @O_TITLE = null;
	Set @O_COURSE_EFF_DATE = null;
	Set @O_COURSE_EXP_DATE = null;
	Set @O_DURATION = null;
	Set @O_Update_TS = null;
	SET @O_COST = NULL;
	--EXEC @OfferAttend_COUNT = OfferAttendance @OFFERING_NUMBER =  
	If @I_COURSE_ID is null
		begin
			exec usp_Push_4_RetCd 50101, @RetCd1 = @RetCd1 output, @RetCd2 = @RetCd2 output, @RetCd3 = @RetCd3 output, @RetCd4 = @RetCd4 output
			Set @TrStat = 'E';
			GOTO stop_all
		end
	If  ((@I_TITLE is null) and (@I_COURSE_EFF_DATE is null) and (@I_COURSE_EXP_DATE is null) and (@I_DURATION is null) and (@I_COST is null))
		begin
			exec usp_Push_4_RetCd 50102, @RetCd1 = @RetCd1 output, @RetCd2 = @RetCd2 output, @RetCd3 = @RetCd3 output, @RetCd4 = @RetCd4 output
			Set @TrStat = 'E';
			GOTO stop_all
		end
	If  (@I_Update_TS is null) or (@I_Update_TS > current_timestamp)
		begin
			exec usp_Push_4_RetCd 50103, @RetCd1 = @RetCd1 output, @RetCd2 = @RetCd2 output, @RetCd3 = @RetCd3 output, @RetCd4 = @RetCd4 output
			Set @TrStat = 'E';
			GOTO stop_all
		end
	SELECT 
	  @COURSE_ID = COURSE_ID
	, @TITLE = TITLE
	, @COURSE_EFF_DATE = COURSE_EFF_DATE
	, @COURSE_EXP_DATE = COURSE_EXP_DATE
	, @DURATION = DURATION
	, @COST = COST
	, @Update_TS =e.Update_TS
	, @SUBJECT_AUTH_LIMIT = SUBJECT_AUTH_LIMIT
	from COURSE E, SUBJECT_AREA S
	WHERE COURSE_ID = @I_COURSE_ID AND

	      E.SUBJECT_ID = S.SUBJECT_ID;

	If @@ROWCOUNT = 0 
		begin
			exec usp_Push_4_RetCd 50104, @RetCd1 = @RetCd1 output, @RetCd2 = @RetCd2 output, @RetCd3 = @RetCd3 output, @RetCd4 = @RetCd4 output
			Set @TrStat = 'E';
		end
	else
		begin							 
	--		EDIT BELOW IS FOR MANDATORY FIELDS: IF INPUT FOR MANDATORY FIELD MMMMM IS NULL/EMPTY AND DB SHOWS NOT NULL/EMPTY FOR SAME FIELD THEN ERROR 
	--		if( (@I_MMMMM is null ) or (@I_MMMMM = '')) AND ((@MMMMM is not null) and (@MMMMM <>''))
	--			begin
	--				exec usp_Push_4_RetCd MMMM0M, @RetCd1 = @RetCd1 output, @RetCd2 = @RetCd2 output, @RetCd3 = @RetCd3 output, @RetCd4 = @RetCd4 output
	--				Set @TrStat = 'E';
				--	GOTO stop_validate
	--			end
			If @I_TITLE IS NULL
				begin
					exec usp_Push_4_RetCd 50111, @RetCd1 = @RetCd1 output, @RetCd2 = @RetCd2 output, @RetCd3 = @RetCd3 output, @RetCd4 = @RetCd4 output
					Set @TrStat = 'E';
				--	GOTO stop_validate
				end
				
			If @I_COURSE_EFF_DATE > @I_COURSE_EXP_DATE
				begin
					exec usp_Push_4_RetCd 50112, @RetCd1 = @RetCd1 output, @RetCd2 = @RetCd2 output, @RetCd3 = @RetCd3 output, @RetCd4 = @RetCd4 output
					Set @TrStat = 'E';
				--	GOTO stop_validate
				end
--
--NOTE: For IF statement below, if an UPDATABLE input-field (eg. @I_DURATION) is NULL-ALLOWED on db, 
--then you must test for possible input value of '1/01/1753' and treat it as null 
--
			If @I_COST < 0 OR @I_COST > 50000
				begin
					exec usp_Push_4_RetCd 50113, @RetCd1 = @RetCd1 output, @RetCd2 = @RetCd2 output, @RetCd3 = @RetCd3 output, @RetCd4 = @RetCd4 output
					Set @TrStat = 'E';
				--	GOTO stop_validate
				end
			If (@I_DURATION <= 0) OR (@I_DURATION >= 50)
				begin
					exec usp_Push_4_RetCd 50114, @RetCd1 = @RetCd1 output, @RetCd2 = @RetCd2 output, @RetCd3 = @RetCd3 output, @RetCd4 = @RetCd4 output
					Set @TrStat = 'E';
				--	GOTO stop_validate
				end
			If (@I_COST < 500) AND (@I_DURATION >= 5)
				begin
					exec usp_Push_4_RetCd 50115, @RetCd1 = @RetCd1 output, @RetCd2 = @RetCd2 output, @RetCd3 = @RetCd3 output, @RetCd4 = @RetCd4 output
					Set @TrStat = 'E';
				--	GOTO stop_validate
				end
			If (@I_COST >= 500) AND (@I_DURATION < 5)
				begin
					exec usp_Push_4_RetCd 50116, @RetCd1 = @RetCd1 output, @RetCd2 = @RetCd2 output, @RetCd3 = @RetCd3 output, @RetCd4 = @RetCd4 output
					Set @TrStat = 'E';
				--	GOTO stop_validate
				end
			If (@O_COST < 200) AND ((@SUBJECT_AUTH_LIMIT is null) OR (@SUBJECT_AUTH_LIMIT < 500000))
				begin
					exec usp_Push_4_RetCd 50117, @RetCd1 = @RetCd1 output, @RetCd2 = @RetCd2 output, @RetCd3 = @RetCd3 output, @RetCd4 = @RetCd4 output
					Set @TrStat = 'E';
				--	GOTO stop_validate
				end
--SELECT A.OFFERING_ID, F.COURSE_ID
--FROM ATTENDANCE A, OFFERING F
--WHERE A.OFFERING_ID = F.OFFERING_ID 
--GROUP BY F.COURSE_ID

			If( @O_COST > @I_COST) AND @OfferAttend_COUNT >= 1
				begin
					exec usp_Push_4_RetCd 50118, @RetCd1 = @RetCd1 output, @RetCd2 = @RetCd2 output, @RetCd3 = @RetCd3 output, @RetCd4 = @RetCd4 output
					Set @TrStat = 'E';
				--	GOTO stop_validate
				end
		stop_validate:
							
								
		end
		IF @TrStat = 'E'
		GOTO stop_all
		ELSE
		BEGIN
				SET TRANSACTION ISOLATION LEVEL REPEATABLE READ;
				BEGIN TRAN;
				DECLARE @rowcount int = 0;
				DECLARE c1_COURSE  CURSOR FOR
				Select TITLE, COURSE_EFF_DATE, COURSE_EXP_DATE, DURATION, COST,Update_TS from COURSE Where  COURSE_ID = @I_COURSE_ID;
				OPEN c1_COURSE
				FETCH NEXT FROM c1_COURSE INTO @TITLE, @COURSE_EFF_DATE, @COURSE_EXP_DATE, @DURATION, @Update_TS;
					WHILE @@FETCH_STATUS = 0
						BEGIN
							Set @rowcount = @rowcount +1;
							if(cast(@Update_TS as nvarchar) <> cast(@I_Update_TS as nvarchar))
								BEGIN
									exec usp_Push_4_RetCd 50105, @RetCd1 = @RetCd1 output, @RetCd2 = @RetCd2 output, @RetCd3 = @RetCd3 output, @RetCd4 = @RetCd4 output
									--Set @TrStat = 'E';
									GOTO stop_trans;
								END
							ELSE
								BEGIN
--NOTE: Before UPDDATE statement below, if an UPDATABLE input-field (eg. @I_DURATION) is NULL-ALLOWED on db, 
--then you must test for possible input value of '1/01/1753' and if true then substitute null-value instead  
--
-- IF @I_DURATION = '1/01/1753'
-- BEGIN
-- SET @I_DURATION = null;
-- END					
									Set @Update_TS = current_timestamp;
									Update COURSE 
									set TITLE = @I_TITLE,
									    COURSE_EFF_DATE = CAST(@I_COURSE_EFF_DATE AS DATETIME),
									    COURSE_EXP_DATE = CAST(@I_COURSE_EXP_DATE AS DATETIME),
									    DURATION = @I_DURATION,
										COST = @I_COST,
									--  UFFF? = cast(@I_UFFF? as datetime),   -- Try this cast if field is datetime
									    Update_TS = @Update_TS
									Where  COURSE_ID = @I_COURSE_ID;
									Set @O_TITLE = @I_TITLE;
									Set @O_COURSE_EFF_DATE = CAST(@I_COURSE_EFF_DATE AS DATETIME);
									Set @O_COURSE_EXP_DATE = CAST(@I_COURSE_EXP_DATE AS DATETIME);
									Set @O_DURATION = @I_DURATION;
									SET @O_COST = @I_COST;
									--Set @O_UFFF? = cast(@I_UFFF? as datetime);  -- Try this cast if field is datetime
									Set @O_Update_TS = @Update_TS;
								END
							FETCH NEXT FROM c1_COURSE INTO @TITLE, @COURSE_EFF_DATE, @COURSE_EXP_DATE, @DURATION, @COST, @Update_TS;
						END			
				If @rowcount = 0
					BEGIN
						exec usp_Push_4_RetCd 50106, @RetCd1 = @RetCd1 output, @RetCd2 = @RetCd2 output, @RetCd3 = @RetCd3 output, @RetCd4 = @RetCd4 output
						--Set @TrStat = 'E';
						GOTO stop_trans;
					END
				If @rowcount > 1
					BEGIN
						exec usp_Push_4_RetCd 50107, @RetCd1 = @RetCd1 output, @RetCd2 = @RetCd2 output, @RetCd3 = @RetCd3 output, @RetCd4 = @RetCd4 output
						--Set @TrStat = 'E';
						GOTO stop_trans;
					END
				exec usp_Push_4_RetCd 0, @RetCd1 = @RetCd1 output, @RetCd2 = @RetCd2 output, @RetCd3 = @RetCd3 output, @RetCd4 = @RetCd4 output
				CLOSE c1_COURSE;
				DEALLOCATE c1_COURSE;
				COMMIT; 
				return
		END
				stop_trans:
						Set @O_TITLE = null;
						Set @O_COURSE_EFF_DATE = null;
						Set @O_COURSE_EXP_DATE = null;
						Set @O_DURATION = null;
						SET @O_COST = NULL;
						Set @O_Update_TS = null;
						CLOSE c1_COURSE;
						DEALLOCATE c1_COURSE;
						ROLLBACK;
						return

stop_all:
		Set @O_TITLE = null;
		Set @O_COURSE_EFF_DATE = null;
		Set @O_COURSE_EXP_DATE = null;
		Set @O_DURATION = null;
		SET @O_COST = NULL;
		Set @O_Update_TS = null;
		return
end

